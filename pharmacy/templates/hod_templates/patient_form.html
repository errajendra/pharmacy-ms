{% extends 'hod_templates/base_template.html'%}
{% load crispy_forms_tags %}
{% block page_title %}
<h5>Add patient</h5>

{% endblock page_title %}
{% block main_content %}
<section class="content" style="">
    <div class="container-fluid">

        <div class="row mt-3">
            <div class="col-md-12">
                <!-- general form elements -->
                <div class="card card-info">
                    <div class="card-header">
                        <h3 class="card-title">Add Patient</h3>
                    </div>
                    <!-- /.card-header -->
                    <!-- form start -->

                    <form id="myForm" role="form" method="POST" enctype="multipart/form-data" class="uniForm">
                        {% csrf_token %} {% if messages %}
                        <div class="form-group">
                            <div class="col-12">
                                {% for message in messages %} {% if message.tags == "error" %}
                                <div class="col-sm-12">
                                    <div class="alert fade alert-simple alert-danger alert-dismissible text-left font__family-montserrat font__size-16 font__weight-light brk-library-rendered rendered show mt-1 " role="alert" data-brk-library="component__alert">
                                        <button type="button" class="close font__size-18" data-dismiss="alert">
                                                                    <span aria-hidden="true">
                                                                        <i class="fa fa-times danger "></i>
                                                                    </span>
                                                                    <span class="sr-only">Close</span>
                                                                </button>
                                        <i class="start-icon far fa-times-circle faa-pulse animated"></i>
                                        <strong class="font__weight-semibold">Oh snap!</strong> {{message}}
                                    </div>
                                </div>
                                {% elif message.tags == "success" %}
                                <div class="alert fade alert-simple alert-success alert-dismissible text-left font__family-montserrat font__size-16 font__weight-light brk-library-rendered rendered show mt-1">
                                    <button type="button" class="close font__size-18" data-dismiss="alert">
                                                                  <span aria-hidden="true">
                                                  <i class="fa fa-times greencross"></i>
                                                  </a></span>
                                                                  <span class="sr-only">Close</span> 
                                                              </button>
                                    <i class="start-icon far fa-check-circle faa-tada animated"></i>
                                    <strong class="font__weight-semibold">Well done!</strong> {{message}}
                                </div>
                                {% endif %} {% endfor %}
                            </div>
                        </div>
                        {% endif %}

                        <div class="card-body">
                            {{form|crispy}}
                            <!-- <div class="form-group">
                                {% for field in form %}
                        
                                        {{ field.errors }}
                                        {{ field.label_tag }}
                                        {{ field }}
                                        {% endfor %}

                                    </div> -->




                        </div>
                        <!-- /.card-body -->

                        <div class="card-footer">
                            <button type="submit" name="action" class="btn btn-primary" value="submit1">Save</button>
                            <button type="submit" name="action" class="btn btn-primary" value="submit2">Save & Next</button>
                        </div>
                    </form>
                </div>
                <!-- /.card -->

            </div>
        </div>

    </div>

    <script>
        document.getElementById("myForm").addEventListener("submit", function(event) {
            // Get the value of the clicked submit button
            var action = event.submitter.getAttribute('value');
    
            // Dynamically set the form's action based on the clicked button
            if (action === "submit1") {
                this.action = "{% url 'patient_form' %}";
            } else if (action === "submit2") {
                this.action = "{% url 'patient_form_and_next' %}";
            } else {
                // Default action if no button was clicked
                this.action = ""; // Or specify a default URL
            }
        });
    </script>
</section>
{% endblock main_content %}